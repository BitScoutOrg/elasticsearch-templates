version: 2016.03.10.0

defaults:
  type: string
  doc_values: true
  index: not_analyzed

syslog:
  type: group
  description: >
    Contains common fields, this is what populates the actual the mappings of the _default_.
    Oritinated from the mapping for rsyslog clients, but can be used with other clients as well.
    _type of the documents should be 'rsyslog'
  fields:
    - name: CEE
      type: group
      product_subgroup: True
      description: >
        Previously a CEE structure as it comes from rsyslog.
        TODO: come up with a good name as CEE is very specific to syslog

    - type: group
      description: >
        rsyslog/syslog-specific metadata, excluding systemd metadata.
      name: rsyslog
      fields:
      - name: facility
        type: string
        description: >
          rsyslog's facility. see syslog specification for more information

      - name: protocol-version
        type: string
        description: >
           rsyslog protocol version

      - name: structured-data
        type: string
        description: >
          syslog's structured-data. see syslog specification for more information
        norms:
          enabled: false

      - name: msgid
        type: long
        description: >
           rsyslog protocol version

      - name: appname
        type: string
        description: >
          syslog's APP-NAME. If APP-NAME is same as programname, we only fill top-level field 'service'.
          If APP-NAME is not equal to programname, this field will hold APP-NAME. See syslog specification for more information

    - name: systemd
      type: group
      description: >
        systemd-specific metadata.
      fields:
      - name: k
        type: group
        description: >
          systemd's kernel-specific metadata.
        fields:
        - name: KERNEL_DEVICE
          type: string
          description: >
            TODO

        - name: KERNEL_SUBSYSTEM
          type: string
          description: >
            TODO

        - name: UDEV_DEVLINK
          type: string
          description: >
            TODO

        - name: UDEV_DEVNODE
          type: string
          description: >
            TODO

        - name: UDEV_SYSNAME
          type: string
          description: >
             TODO

      - name: t
        type: group
        description: >
          TODO.
        fields:
        - name: AUDIT_LOGINUID
          type: string
          description: >
            TODO

        - name: BOOT_ID
          type: string
          description: >
            TODO

        - name: AUDIT_SESSION
          type: string
          description: >
            TODO

        - name: CAP_EFFECTIVE
          type: string
          description: >
            TODO

        - name: CMDLINE
          type: string
          description: >
            TODO
          norms:
            enabled: false

        - name: COMM
          type: string
          description: >
            TODO

        - name: EXE
          type: string
          description: >
            TODO
          norms:
            enabled: false

        - name: GID
          type: string
          description: >
            TODO

        - name: HOSTNAME
          type: string
          description: >
            TODO

        - name: MACHINE_ID
          type: string
          description: >
            TODO

        - name: PID
          type: string
          description: >
            TODO

        - name: SELINUX_CONTEXT
          type: string
          description: >
            TODO

        - name: SOURCE_REALTIME_TIMESTAMP
          type: string
          description: >
            TODO

        - name: SYSTEMD_CGROUP
          type: string
          description: >
            TODO

        - name: SYSTEMD_OWNER_UID
          type: string
          description: >
            TODO

        - name: SYSTEMD_SESSION
          type: string
          description: >
            TODO

        - name: SYSTEMD_SLICE
          type: string
          description: >
            TODO

        - name: SYSTEMD_UNIT
          type: string
          description: >
            TODO

        - name: SYSTEMD_USER_UNIT
          type: string
          description: >
            TODO

        - name: TRANSPORT
          type: string
          description: >
            TODO

        - name: UID
          type: string
          description: >
            TODO

      - name: u
        type: group
        description: >
          TODO.
        fields:
        - name: CODE_FILE
          type: string
          norms:
            enabled: false
          description: >
            TODO

        - name: CODE_FUNCTION
          type: string
          description: >
            TODO

        - name: CODE_LINE
          type: string
          description: >
            TODO

        - name: ERRNO
          type: string
          description: >
            TODO

        - name: MESSAGE_ID
          type: string
          description: >
            TODO

        - name: RESULT
          type: string
          norms:
            enabled: false
          description: >
            TODO

        - name: UNIT
          type: string
          description: >
            TODO
